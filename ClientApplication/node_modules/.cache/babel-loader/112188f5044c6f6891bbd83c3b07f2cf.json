{"ast":null,"code":"var _jsxFileName = \"D:\\\\vitus\\\\Documents\\\\Szakdolgozat\\\\AuctionApplication\\\\ClientApplication\\\\src\\\\Auctions\\\\Biding.tsx\";\nimport React from \"react\";\nimport { useState } from 'react';\nimport { useEffect } from 'react';\nimport axios from 'axios';\nimport Button from \"react-bootstrap/Button\";\nimport Card from \"react-bootstrap/Card\";\nimport { useAuth } from \"../Services/AuthService\";\nimport authHeader from \"../Services/TokenService\";\nimport userId from '../Services/UserService';\nimport { stringFromDate } from '../Services/DateService';\nimport { connection } from '../Services/SignalRHubService';\nexport default function SendBid(props) {\n  const [sum, setSum] = useState(props.maxsum);\n  const [aucid, setId] = useState(props.id);\n  const {\n    authTokens\n  } = useAuth();\n  const userid = userId().id;\n  const username = userId().username;\n  const now = new Date();\n  var a = [];\n  const [data, setData] = useState(a);\n  const i = props.id;\n  const [isLoading, setIsLoading] = useState(false);\n  const [isError, setIsError] = useState(false);\n  const [hubConnection, setHubConnection] = useState(connection);\n  useEffect(() => {\n    const fetchData = async () => {\n      setIsError(false);\n      setIsLoading(true);\n\n      try {\n        const res = await axios.get('https://localhost:5001/api/bid/' + i, {\n          headers: authHeader()\n        });\n        setData(res.data);\n      } catch (error) {\n        console.log(error);\n      }\n\n      setIsLoading(false);\n\n      try {\n        await hubConnection.start();\n        console.log('Connection successful!');\n      } catch (err) {\n        console.log(err);\n      }\n\n      hubConnection.on('ReceiveSum', (id, sum, name, date) => {\n        setSum(sum);\n\n        if (id === i) {\n          var _document$getElementB;\n\n          var node = document.createElement(\"LI\");\n          node.innerHTML = \"<b>\" + sum + \" Ft</b> by \" + name + \" at \" + stringFromDate(date);\n          (_document$getElementB = document.getElementById(\"sumlist\")) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.appendChild(node);\n          console.log(\"receive\");\n        }\n      });\n    };\n\n    fetchData();\n    return () => {\n      hubConnection.off('ReceiveSum');\n      hubConnection.stop();\n    };\n  }, []);\n  useEffect(() => {\n    const startConnection = async () => {\n      try {\n        await hubConnection.start();\n        console.log('Connection successful!');\n      } catch (err) {\n        console.log(err);\n      }\n\n      hubConnection.on('ReceiveSum', (id, sum, name, date) => {\n        setSum(sum);\n\n        if (id === i) {\n          var _document$getElementB2;\n\n          var node = document.createElement(\"LI\");\n          node.innerHTML = \"<b>\" + sum + \" Ft</b> by \" + name + \" at \" + stringFromDate(date);\n          (_document$getElementB2 = document.getElementById(\"sumlist\")) === null || _document$getElementB2 === void 0 ? void 0 : _document$getElementB2.appendChild(node);\n          console.log(\"receive\");\n        }\n      });\n    };\n\n    startConnection();\n    return () => {\n      hubConnection.off('ReceiveSum');\n      hubConnection.stop();\n    };\n  }, []);\n\n  const handleSubmit = async () => {\n    if (sum > props.maxsum) {\n      await axios.post('https://localhost:5001/api/bid', {\n        \"sum\": sum,\n        \"auctionid\": aucid,\n        \"personid\": userid,\n        \"personName\": username,\n        \"time\": now\n      }, {\n        headers: authHeader()\n      });\n    }\n  };\n\n  if (authTokens) return React.createElement(Card, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }), React.createElement(\"form\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"input-group-prepend text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    className: \"form-control\",\n    type: \"number\",\n    value: sum,\n    onChange: e => {\n      setSum(+e.currentTarget.value);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"input-group-text\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, \"Ft\")), React.createElement(Button, {\n    className: \"btn\",\n    onClick: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, \"Send bid\"))), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }), React.createElement(\"ul\", {\n    id: \"sumlist\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, data.map(item => React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, item.sum, \" Ft\"), \" by \", item.personName, \" at \", stringFromDate(item.time)))));else {\n    return React.createElement(\"div\", {\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"You should \", React.createElement(\"a\", {\n      href: \"/login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"sign in\"), \" before you can bid\");\n  }\n}","map":{"version":3,"sources":["D:/vitus/Documents/Szakdolgozat/AuctionApplication/ClientApplication/src/Auctions/Biding.tsx"],"names":["React","useState","useEffect","axios","Button","Card","useAuth","authHeader","userId","stringFromDate","connection","SendBid","props","sum","setSum","maxsum","aucid","setId","id","authTokens","userid","username","now","Date","a","data","setData","i","isLoading","setIsLoading","isError","setIsError","hubConnection","setHubConnection","fetchData","res","get","headers","error","console","log","start","err","on","name","date","node","document","createElement","innerHTML","getElementById","appendChild","off","stop","startConnection","handleSubmit","post","e","currentTarget","value","map","item","personName","time"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { useState } from 'react';\r\nimport { useEffect } from 'react';\r\nimport { HubConnection, HubConnectionBuilder } from '@microsoft/signalr';\r\nimport axios from 'axios';\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Col from \"react-bootstrap/Col\";\r\nimport Row from \"react-bootstrap/Row\";\r\nimport Container from \"react-bootstrap/Container\";\r\nimport Card from \"react-bootstrap/Card\";\r\nimport { useAuth } from \"../Services/AuthService\";\r\nimport Moment from 'react-moment';\r\nimport { Bid } from '../Common/Interfaces';\r\nimport authHeader from \"../Services/TokenService\";\r\nimport  userId  from '../Services/UserService';\r\nimport { stringFromDate } from '../Services/DateService';\r\nimport { connection } from '../Services/SignalRHubService';\r\n\r\ninterface IProps {\r\n    id : number;\r\n    maxsum : number;\r\n  }\r\n\r\n\r\n  export default function SendBid(props:IProps){\r\n    const [sum, setSum] = useState(props.maxsum);\r\n    const [aucid, setId] = useState(props.id);\r\n    const { authTokens } = useAuth();\r\n    const userid = userId().id;\r\n    const username = userId().username;\r\n    const now : Date = new Date();\r\n    var a: Bid[] = [];\r\n    const [data, setData] = useState(a);\r\n    const i:number =props.id;\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [isError, setIsError] = useState(false);\r\n    const [hubConnection, setHubConnection] = useState<HubConnection>(connection);\r\n\r\n\r\n    useEffect(() => {\r\n      const fetchData = async () => {\r\n        setIsError(false);\r\n        setIsLoading(true);\r\n          try {\r\n                const res = await axios.get<Bid[]>('https://localhost:5001/api/bid/'+i, { headers: authHeader() });\r\n                setData(res.data); \r\n              }\r\n           catch (error) {  \r\n                console.log(error);\r\n              }\r\n          setIsLoading(false);\r\n          try {\r\n                 await hubConnection.start()\r\n                 console.log('Connection successful!')\r\n               }\r\n          catch (err) {\r\n              console.log(err);\r\n          }\r\n\r\n          hubConnection.on('ReceiveSum', (id, sum, name, date) => {\r\n            setSum(sum);\r\n            if(id === i){   \r\n            var node = document.createElement(\"LI\");\r\n            node.innerHTML=\"<b>\" +sum+ \" Ft</b> by \"+name+\" at \"+ stringFromDate(date);\r\n            document.getElementById(\"sumlist\")?.appendChild(node);\r\n            console.log(\"receive\");\r\n            }\r\n          });\r\n\r\n      };\r\n      fetchData();\r\n      return () => {\r\n        hubConnection.off('ReceiveSum');\r\n        hubConnection.stop();\r\n      }\r\n    },[]);\r\n\r\n    useEffect(() => {\r\n      const startConnection = async () => { \r\n          try {\r\n                 await hubConnection.start()\r\n                 console.log('Connection successful!')\r\n               }\r\n          catch (err) {\r\n              console.log(err);\r\n          }\r\n          hubConnection.on('ReceiveSum', (id, sum, name, date) => {\r\n            setSum(sum);\r\n            if(id === i){   \r\n            var node = document.createElement(\"LI\");\r\n            node.innerHTML=\"<b>\" +sum+ \" Ft</b> by \"+name+\" at \"+ stringFromDate(date);\r\n            document.getElementById(\"sumlist\")?.appendChild(node);\r\n            console.log(\"receive\");\r\n            }\r\n          });\r\n      };\r\n      startConnection();\r\n      return () => {\r\n        hubConnection.off('ReceiveSum');\r\n        hubConnection.stop();\r\n      }\r\n    },[]);\r\n\r\n    \r\n   \r\n    \r\n    const handleSubmit= async ()=> {\r\n     if(sum>props.maxsum){\r\n      await axios.post('https://localhost:5001/api/bid', {\r\n          \"sum\": sum,\r\n          \"auctionid\": aucid,\r\n          \"personid\": userid,\r\n          \"personName\":username,\r\n          \"time\": now\r\n        },{ headers: authHeader() });\r\n      }\r\n    }\r\n    \r\n    if(authTokens)\r\n      return (\r\n          <Card>  \r\n                      <br/>\r\n                      <form>\r\n                <div className=\"text-center\">\r\n                <label className=\"input-group-prepend text-center\">\r\n                 <input className=\"form-control\" type=\"number\" value={sum} onChange={(e: React.FormEvent<HTMLInputElement>)=>{ setSum(+e.currentTarget.value);}} />\r\n                 <div className=\"input-group-text\">Ft</div>\r\n                 </label>\r\n                 <Button className=\"btn\" onClick={handleSubmit}>Send bid</Button>\r\n                 \r\n            </div>\r\n        </form>\r\n                      <br/>\r\n                      <ul id=\"sumlist\">\r\n                        {\r\n                           data.map(item => (\r\n                        <li>\r\n                        <b>{item.sum} Ft</b> by {item.personName} at {stringFromDate(item.time)} \r\n                        </li>\r\n                        ))}\r\n                      </ul>\r\n           </Card>\r\n       \r\n      );\r\n      else\r\n      {\r\n        return(\r\n          <div className=\"text-center\">You should <a href=\"/login\">sign in</a> before you can bid</div>\r\n        )\r\n      }\r\n      \r\n    }"]},"metadata":{},"sourceType":"module"}